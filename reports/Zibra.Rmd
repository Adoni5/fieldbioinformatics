---
title: "Zibra"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(ggplot2)
library(jsonlite)
library(knitr)
library(dplyr)
library(ggtree)
```

```{r ct}
samples=fromJSON('https://lims.microbesng.uk/RESTfm/ZiBRA/layout/Sample.json?RFMkey=7O5QG4ejt2HxwB98IJ0lx5w3PA60O3V9&RFMmax=0')$data
ggplot(samples, aes(x=as.integer(ct))) + geom_histogram() + theme_bw()
```

```{r municipality}
ggplot(samples, aes(x=municipality)) + geom_bar(stat="count") + theme_bw() + theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r state}
ggplot(samples, aes(x=state)) + geom_bar(stat="count") + theme_bw() + theme(axis.text.x = element_text(angle=90, hjust=1))
```

## Run statistics

```{r runstats}
runs=read.table("newdata/runstats.txt", header=T, sep="\t")
kable(runs, caption='Run statistics')
```

## Genome statistics

```{r genomestats}
genomes=read.table("genomestats.txt", header=T, sep="\t")
kable(arrange(genomes, -perc), caption='Run statistics')
```

### Histogram

```{r}
ggplot(genomes, aes(x=perc)) + geom_histogram(binwidth=10) + xlim(0,100) + theme_bw()
```

###Â Tree

```{r tree}
tre=read.tree(file='rooted.tre')
ggplot(tre, aes(x, y)) + geom_tree() + theme_tree() + geom_tiplab(size=3, color="red")
```
